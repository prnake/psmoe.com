<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Papersnake"><title>Python 常用技巧 · 纸蛇</title><meta name="description" content="在 Leetcode 上划水写写 Python3 ，主要追求程序的简洁和实现的精巧。Zen of Pythonlru_cache509. 斐波那契数329. 矩阵中的最长递增路径functools使用异常抛出机制解决问题什么是异常？异常处理巧用异常抛出机制350. 两个数组的交集 II迭代器 ite"><meta name="keywords" content="纸蛇,Papersnake,blog"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/icon/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="icon" type="image/png" sizes="32x32" href="/icon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/icon/favicon-16x16.png"><link rel="shortcut icon" href="/icon/favicon.ico"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/fonts.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery-3.5.1.min.js"></script><script src="/js/valine.min.js"></script><meta name="generator" content="Hexo 4.2.1"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" style="outline:0" class="site-title-small"><a id="hitokoto" href="/" style="outline:0" class="a-title">Anything that can go wrong will go wrong.</a></h3><h1 tabindex="-1" style="outline:0" class="site-title-large"><a href="/" style="outline:0" class="a-title">纸蛇</a></h1></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/categories">分类</a></li><li><a href="/tags">标签</a></li><li><a href="/about.html">关于</a></li><li class="soc"><a href="https://github.com/prnake" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a><a href="https://twitter.com/papersnake" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter">&nbsp;</i></a><a href="https://psmoe.com/atom.xml" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2019-2021&nbsp;<a target="_blank" href="https://psmoe.com" rel="noopener noreferrer">Papersnake</a></p><p>Theme by&nbsp;<a target="_blank" href="https://github.com/prnake/hexo-theme-typography-plus" rel="noopener noreferrer">Typography</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p><p>Hosted by&nbsp;<a target="_blank" href="https://cloud.tencent.com/product/wh?from=12331" rel="noopener noreferrer">云开发 Cloudbase</a></p><p><a target="_blank" href="/sitemap.xml">站点地图 · </a><a target="_blank" href="http://beian.miit.gov.cn/" rel="noopener noreferrer">湘ICP备19014548号</a></p><p><span id="since"></span><span class="my-face">(=^･ｪ･^=)</span></p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><h1 class="post-title">Python 常用技巧</h1><p class="post-meta"><span class="date meta-item">发布于&nbsp;2020-07-27</span><span class="meta-item"><i class="fa fa-folder"></i><span>&nbsp;</span><a href="/categories/Coding/" title="Coding" class="a-tag">Coding</a><span>&nbsp;</span></span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a href="/tags/python/" title="python" class="a-tag">python</a><span>&nbsp;</span></span></p><p class="post-meta">本文共计&nbsp;<span class="post-count">1.5k</span>&nbsp;字，预计阅读时长&nbsp;<span class="post-count">6</span>&nbsp;分钟，被阅读&nbsp;<span id="/python-skills/" data-flag-title="python-skills/" class="leancloud_visitors"><span class="leancloud-visitors-count"></span></span>&nbsp;次。</p><p class="post-abstract"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"></p><p>在 Leetcode 上划水写写 Python3 ，主要追求程序的简洁和实现的精巧。</p><a id="more"></a><ul><li><a href="#zen-of-python">Zen of Python</a></li><li><a href="#lru_cache">lru_cache</a><ul><li><a href="#509-斐波那契数">509. 斐波那契数</a></li><li><a href="#329-矩阵中的最长递增路径">329. 矩阵中的最长递增路径</a></li><li><a href="#functools">functools</a></li></ul></li><li><a href="#使用异常抛出机制解决问题">使用异常抛出机制解决问题</a><ul><li><a href="#什么是异常">什么是异常？</a></li><li><a href="#异常处理">异常处理</a></li><li><a href="#巧用异常抛出机制">巧用异常抛出机制</a></li><li><a href="#350-两个数组的交集-ii">350. 两个数组的交集 II</a></li></ul></li><li><a href="#迭代器-iter">迭代器 iter</a><ul><li><a href="#392-判断子序列">392. 判断子序列</a></li></ul></li></ul><h2><span id="zen-of-python">Zen of Python</span></h2><blockquote><p><strong>生活的最好状态是冷冷清清的风风火火。 ——木心</strong></p></blockquote><pre><code class="python">&gt;&gt;&gt; import this
The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren&#39;t special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you&#39;re Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it&#39;s a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let&#39;s do more of those!</code></pre><h2><span id="lru_cache">lru_cache</span></h2><p><code>lru_cache</code> 属于 <code>functools</code> ，是一个为函数提供缓存功能的装饰器，利用的是 <a href="https://en.wikipedia.org/wiki/Cache_algorithms#Examples" target="_blank" rel="noopener external nofollow noreferrer">最久未使用算法 (Least recently used)</a> 进行缓存。适合在<strong>需要重用之前计算结果，且函数参数可哈希</strong>的情况下使用。比如<strong>动态规划、记忆化搜索</strong>，可以减少存储计算结果的代码。</p><p>该函数的默认调用参数为<code>@functools.lru_cache(maxsize=128, typed=False)</code>。特别的，如果 <em>maxsize</em> 设为 <code>None</code>，LRU 特性将被禁用且缓存可无限增长。</p><h3><span id="509-斐波那契数">509. 斐波那契数</span></h3><pre><code class="python">class Solution:
    @lru_cache(None)
    def fib(self, N: int) -&gt; int:
        if N &lt; 2:
            return N
        return self.fib(N-1) + self.fib(N-2)</code></pre><h3><span id="329-矩阵中的最长递增路径">329. 矩阵中的最长递增路径</span></h3><blockquote><p>给定一个整数矩阵，找出最长递增路径的长度。</p><p>对于每个单元格，你可以往上，下，左，右四个方向移动。 你不能在对角线方向上移动或移动到边界外（即不允许环绕）。</p></blockquote><p>直接使用 <code>dfs</code> + <code>lru_cache</code> ：</p><pre><code class="python">class Solution:
    def longestIncreasingPath(self, matrix: List[List[int]]) -&gt; int:
        @lru_cache(None)
        def dfs(i,j):
            res = 1
            if i-1&gt;=0 and matrix[i-1][j]&gt;matrix[i][j]:
                res=max(res,dfs(i-1,j)+1)
            if i+1&lt;len(matrix) and matrix[i+1][j]&gt;matrix[i][j]:
                res=max(res,dfs(i+1,j)+1)
            if j-1&gt;=0 and matrix[i][j-1]&gt;matrix[i][j]:
                res=max(res,dfs(i,j-1)+1)
            if j+1&lt;len(matrix[0]) and matrix[i][j+1]&gt;matrix[i][j]:
                res=max(res,dfs(i,j+1)+1)
            return res
        res = 0
        for i in range(len(matrix)):
            for j in range(len(matrix[0])):
                res = max(res,dfs(i,j))
        return res</code></pre><h3><span id="functools">functools</span></h3><blockquote><p><a href="https://docs.python.org/zh-cn/3/library/functools.html#module-functools" target="_blank" rel="noopener external nofollow noreferrer"><code>functools</code></a> 模块应用于高阶函数，即参数或（和）返回值为其他函数的函数。 通常来说，此模块的功能适用于所有可调用对象。</p></blockquote><p>看起来还有很多的功能可以挖掘。</p><h2><span id="使用异常抛出机制解决问题">使用异常抛出机制解决问题</span></h2><h3><span id="什么是异常">什么是异常？</span></h3><ul><li>异常即是一个事件，该事件会在程序执行过程中发生，影响了程序的正常执行。</li><li>一般情况下，在 Python 无法正常处理程序时就会发生一个异常。</li><li>异常是 Python 对象，表示一个错误。</li><li>当 Python 脚本发生异常时我们需要捕获处理它，否则程序会终止执行。</li></ul><h3><span id="异常处理">异常处理</span></h3><p>捕捉异常可以使用 try/except 语句。</p><p>try/except 语句用来检测 try 语句块中的错误，从而让 except 语句捕获异常信息并处理。</p><p>如果你不想在异常发生时结束你的程序，只需在 try 里捕获它。</p><p>以下为简单的语法：</p><pre><code class="python">try:
&lt;语句&gt;        #运行别的代码
except &lt;名字&gt;：
&lt;语句&gt;        #如果在 try 部份引发了&#39;name&#39;异常
except &lt;名字&gt;，&lt;数据&gt;:
&lt;语句&gt;        #如果引发了&#39;name&#39;异常，获得附加的数据
else:
&lt;语句&gt;        #如果没有异常发生</code></pre><p>try 的工作原理是，当开始一个 try 语句后，python 就在当前程序的上下文中作标记，这样当异常出现时就可以回到这里，try 子句先执行，接下来会发生什么依赖于执行时是否出现异常。</p><ul><li>如果当 try 后的语句执行时发生异常，python 就跳回到 try 并执行第一个匹配该异常的 except 子句，异常处理完毕，控制流就通过整个 try 语句（除非在处理异常时又引发新的异常）。</li><li>如果在 try 后的语句里发生了异常，却没有匹配的 except 子句，异常将被递交到上层的 try，或者到程序的最上层（这样将结束程序，并打印默认的出错信息）。</li><li>如果在 try 子句执行时没有发生异常，python 将执行 else 语句后的语句（如果有 else 的话），然后控制流通过整个 try 语句。</li></ul><h3><span id="巧用异常抛出机制">巧用异常抛出机制</span></h3><p>当遇到<strong>索引访问越界或者不被数据结构认可的处理方式</strong>时，可以采用 <code>try &amp; except</code> 语句减少合法性判断的代码。</p><h3><span id="350-两个数组的交集-ii">350. 两个数组的交集 II</span></h3><blockquote><p>给定两个数组，编写一个函数来计算它们的交集。</p></blockquote><pre><code class="python">class Solution:
    def intersect(self, nums1: List[int], nums2: List[int]) -&gt; List[int]:
        res = []
        for num in nums1:
            try:
                nums2.remove(num)
                res.append(num)
            except:
                continue

        return res</code></pre><h2><span id="迭代器-iter">迭代器 iter</span></h2><p>迭代器的好处是 <code>for in</code> 遍历时，迭代器自身也会移动，适合处理只需要使用一次的数据。</p><h3><span id="392-判断子序列">392. 判断子序列</span></h3><blockquote><p>给定字符串 s 和 t ，判断 s 是否为 t 的子序列。</p><p>你可以认为 s 和 t 中仅包含英文小写字母。字符串 t 可能会很长（长度 ~= 500,000），而 s 是个短字符串（长度 &lt;=100）。</p><p>字符串的一个子序列是原始字符串删除一些（也可以不删除）字符而不改变剩余字符相对位置形成的新字符串。（例如，”ace”是”abcde”的一个子序列，而”aec”不是）。</p></blockquote><pre><code class="python">class Solution:
    def isSubsequence(self, s: str, t: str) -&gt; bool:
        t = iter(t)
        return all(c in t for c in s) #t 在 c in t 的查找过程中不断右移</code></pre><p></p></div><hr><p>本文采用 <a itemprop="license" rel="license noopener external nofollow noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">Attribution-NonCommercial 4.0 International</a> 许可协议。</p><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/side-channel-attack/" title="旁路攻击：一道典型题的分析"><i class="fa fa-angle-double-left"></i>&nbsp;上一篇: 旁路攻击：一道典型题的分析</a></span><br><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/hexo-deploy/" title="使用 Github Actions 将 Hexo 托管至腾讯云">下一篇: 使用 Github Actions 将 Hexo 托管至腾讯云&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div><a id="comments"></a><div id="valine-container"></div><script>"undefined"!=typeof Valine&&new Valine({el:"#valine-container",appId:"ufDJM5pqiTtGRDxfWK6SPs6K-gzGzoHsz",appKey:"qwTff74RTdIHtaKOBRFWPIuU",path:window.location.pathname,visitor:!0})</script></div></div></div><script>hitokoto()</script><script>$(document).on("pjax:complete",(function(){$("pre").addClass("prettyprint linenums"),prettyPrint(),setTime()}))</script><script>$(document).on("pjax:complete",(function(){$.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML",(function(){MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}});var t=document.getElementsByClassName("entry-content")[0];MathJax.Hub.Queue(["Typeset",MathJax.Hub,t])}))}))</script><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2019-2021&nbsp;<a target="_blank" href="https://psmoe.com" rel="noopener noreferrer">Papersnake</a></p><p>Theme by&nbsp;<a target="_blank" href="https://github.com/prnake/hexo-theme-typography-plus" rel="noopener noreferrer">Typography</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p><p>Hosted by&nbsp;<a target="_blank" href="https://cloud.tencent.com/product/wh?from=12331" rel="noopener noreferrer">云开发 Cloudbase</a></p><p><a target="_blank" href="/sitemap.xml">站点地图 · </a><a target="_blank" href="http://beian.miit.gov.cn/" rel="noopener noreferrer">湘ICP备19014548号</a></p><p><span id="since"></span><span class="my-face">(=^･ｪ･^=)</span></p></footer></div></div></div></div><button type="button" class="material-scrolltop"></button><script src="/js/bootstrap.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/typography.min.js"></script><script src="/js/material-scrolltop.js"></script><script src="/js/prettify.js"></script><script>function hitokoto(){var o,t=new RegExp("(^| )hitokoto=([^;]*)(;|$)");(o=document.cookie.match(t))?$("#hitokoto").html(o[2]):$("#hitokoto").html(""),$.get("https://v1.hitokoto.cn/?max_length=15",{},(function(o){$("#hitokoto").html(o.hitokoto),document.cookie="hitokoto="+o.hitokoto}),"JSON")}hitokoto()</script><script src="/js/L2Dwidget.min.js"></script><script>function browserRedirect(){var i=navigator.userAgent.toLowerCase(),t="ipad"==i.match(/ipad/i),e="iphone"==i.match(/iphone/i),o="midp"==i.match(/midp/i),a="android"==i.match(/android/i);t||e||o||a||document.write('<script src="/js/L2Dwidget.min.js"><\/script><script>L2Dwidget.init({model:{jsonPath:"/live2d/remu/model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0},react:{opacity:.9},log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})<\/script> ')}browserRedirect()</script><script>$(document).ready((function(){$.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML",(function(){MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}});var a=document.getElementsByClassName("entry-content")[0];MathJax.Hub.Queue(["Typeset",MathJax.Hub,a])}))}))</script><script>$("body").materialScrollTop()</script><script>function setTime(){var e=new Date(2019,6,21,12,0,0),t=((new Date).getTime()-e.getTime())/864e5,n=Math.floor(t),o=24*(t-n),a=Math.floor(o),i=60*(o-a),m=Math.floor(60*(o-a)),r=Math.floor(60*(i-m));document.getElementById("since").innerHTML="博客已运行"+n+"天"+a+"小时"+m+"分"+r+"秒"}setInterval(setTime,1e3),setTime()</script><script>$(document).ready((function(){$("pre").addClass("prettyprint linenums"),prettyPrint()}))</script></body></html>